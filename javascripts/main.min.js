"use strict";var SVGSpriteConfigurator=function(e,t,l,s,a){this.config=e,this.$form=t,this.$compiled=l,this.values={},this.reserved=["label","default","skip","type","options","emphasize"],this.register={},this.debug=!!a,this.tab=null,this.compiled={},this.prepareTabs(s),this.build(this.$form,this.config,[]),this.update()};SVGSpriteConfigurator.prototype.prepareTabs=function(e){var s=this;e.each(function(e,t){var l=$("pre",t);t.template=l.length?l.text():"$$config$$",t.onclick=function(){s.tab=this,s.update()}}),this.tab=e[0]},SVGSpriteConfigurator.prototype.build=function(e,t,l){for(var s in t)switch(t[s].type){case"string":this.buildString(e,s,t[s],l);break;case"integer":this.buildInteger(e,s,t[s],l);break;case"boolean":this.buildBoolean(e,s,t[s],l);break;case"select":this.buildSelect(e,s,t[s],l);break;case"section":this.buildSection(e,s,t[s],l);break;case"enableconfig":this.buildEnableConfig(e,s,t[s],l);break;case"manual":this.buildManual(e,s,t[s],l)}return e},SVGSpriteConfigurator.prototype.buildString=function(e,t,l,s){s=s.join("_")+(s.length?"_":"")+t,t=$('<input type="text" name="'+s+'" data-skip="'+l.skip+'"/>');t.attr("value",this.values[s]),t.attr("placeholder",l.default),e.append($("<label/>").text(l.label).append($('<span class="id"/>').text(s.split("_").join("."))).prepend(t)),this.register[s]=$.extend({_:t[0]},l),t.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildInteger=function(e,t,l,s){s=s.join("_")+(s.length?"_":"")+t,t=$('<input type="number" name="'+s+'" data-skip="'+l.skip+'" min="0" step="1" pattern="d*"/>');t.attr("value",this.values[s]),t.attr("placeholder",l.default),e.append($("<label"+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(s.split("_").join("."))).prepend(t)),this.register[s]=$.extend({_:t[0]},l),t.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildBoolean=function(e,t,l,s){var a=s.join("_")+(s.length?"_":"")+t,s=$('<input type="checkbox" name="'+a+'" value="1" data-skip="'+l.skip+'"'+(l.default?' checked="checked"':"")+"/>"),t=$('<span class="boolean"><input type="hidden" name="'+a+'" value="0"/></span>').append(s);e.append($("<label"+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(a.split("_").join("."))).prepend(t)),this.register[a]=$.extend({_:s[0]},l),s.click($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildSelect=function(e,t,l,s){var a,t=s.join("_")+(s.length?"_":"")+t,i=$('<select name="'+t+'" data-skip="'+l.skip+'"/>'),p=this.values[t]||l.default;for(a in l.options)i.append($('<option value="'+a+'"'+(a==p?' selected="selected"':"")+"/>").text(l.options[a]));e.append($("<label"+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(t.split("_").join("."))).prepend(i)),this.register[t]=$.extend({_:i[0]},l),i.change($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.buildSection=function(e,t,l,s){var a=s.join("_")+(s.length?"_":"")+t,i=!1,p={},n=0,o=this;$.each(this.values,function(e,t){0===e.indexOf(section+"_")&&(i=!0)}),$.each(l,function(e,t){o.reserved.indexOf(e)<0&&(p[e]=t,++n)}),n&&((s=s.slice(0)).push(t),t=$('<label for="'+a+'"'+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(a.split("_").join("."))).prepend('<span class="toggle" data-exand="►" data-collapse="▼"></span>'),t=$("<legend/>").append(t),s=$("<fieldset/>").append($('<input type="checkbox" id="'+a+'" class="section"'+(i?' checked="checked"':"")+' data-skip="'+l.skip+'"/>')).append(t).append(this.build($('<div class="subsection"/>'),p,s)),e.append(s),this.register[a]=l)},SVGSpriteConfigurator.prototype.buildEnableConfig=function(e,t,l,s){var a=s.join("_")+(s.length?"_":"")+t,i=parseInt(this.values[a]||l.default,10),p={},n=0;$.each(this.values,function(e,t){e.indexOf(enable+"_")});var o,r,d,u,c=this;$.each(l,function(e,t){c.reserved.indexOf(e)<0&&(p[e]=t,++n)}),n&&((u=s.slice(0)).push(t),o=$('<input type="radio" id="'+a+'.skip" name="'+a+'" class="skip" value="0"'+(0==i?' checked="checked"':"")+">"),r=$('<label class="enable" for="'+a+'.skip">Skip</label>'),d=$('<input type="radio" id="'+a+'.enable" name="'+a+'" class="enable" value="1"'+(1==i?' checked="checked"':"")+">"),s=$('<label class="enable" for="'+a+'.enable">Enable</label>'),t=$('<input type="radio" id="'+a+'.configure" name="'+a+'" class="configure" value="2"'+(2==i?' checked="checked"':"")+">"),i=$('<label class="enable" for="'+a+'.configure">Configure</label>'),u=$("<fieldset/>").append($('<legend class="label"/>').append($('<label for="'+a+'.enable"'+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(a.split("_").join("."))))).append(d,s,t,i,o,r).append(this.build($('<div class="subsection"/>'),p,u)),e.append(u),this.register[a]=$.extend({_0:o[0],_1:d[0],_2:t[0]},l),o.click($.proxy(this.compile,this)),d.click($.proxy(this.compile,this)),t.click($.proxy(this.compile,this)))},SVGSpriteConfigurator.prototype.buildManual=function(e,t,l,s){s=s.join("_")+(s.length?"_":"")+t,t=$('<span class="manual"><input type="checkbox" name="'+s+'" value="1" data-skip="'+l.skip+'"'+(l.default?' checked="checked"':"")+"/> Enable and edit manually</span>");e.append($("<label"+(l.emphasize?' class="emphasize"':"")+"/>").text(l.label).append($('<span class="id"/>').text(s.split("_").join("."))).prepend(t)),this.register[s]=$.extend({_:t[0]},l),t.click($.proxy(this.compile,this))},SVGSpriteConfigurator.prototype.compile=function(){for(var e,t={},l=this.$form.serializeArray(),s=0;s<l.length;++s)this.traverse(l[s].name.split("_"),l[s].value,t,this.config);for(e in t)this.refine(e,t,this.config);this.compiled=t,this.update()},SVGSpriteConfigurator.prototype.update=function(){console.log(this.tab.template);var e=JSON.stringify(this.compiled,null,4),e=this.tab.template.split("$$config$$").join(e),e=Prism.highlight(e,Prism.languages.javascript);this.$compiled.html(e)},SVGSpriteConfigurator.prototype.traverse=function(e,t,l,s,a){var i=e.shift();if(!(i in s))throw new"Invalid property: ".property;if(e.length)i in l||(l[i]={}),this.traverse(e,t,l[i],s[i],(a||"")+i+"_");else{switch(s[i].type){case"string":t=$.trim(t);break;case"integer":t=Math.max(0,parseInt(t||0,10));break;case"boolean":t=!!parseInt(t||0,10);break;case"select":break;case"enableconfig":t=Math.max(0,Math.min(2,parseInt(t||0,10)));break;case"manual":t=parseInt(t||0,10)?{}:null}i in l?l[i]._=t:l[i]={_:t}}},SVGSpriteConfigurator.prototype.refine=function(e,t,l){var s=l[e],a=s.default,i=parseInt(s.skip||0,10),p=t[e]._,n=0;switch(s.process||s.type){case"integer":if(!p&&1&i){delete t[e];break}case"string":case"select":!(""+p).length&&1&i||p===a&&2&i?delete t[e]:(t[e]=p,++n);break;case"section":var o=0;for(r in t[e])o+=this.refine(r,t[e],s);o?n+=o:delete t[e];break;case"boolean":p===a&&2&i?delete t[e]:(t[e]=p,++n);break;case"enableconfig":if(a===p&&2&i)delete t[e];else if(p<2)t[e]=!!p,++n;else{o=0;for(r in t[e])"_"!=r&&(o+=this.refine(r,t[e],s));o?(delete t[e]._,n+=o):(t[e]=!0,++n)}break;case"manual":p?(t[e]=p,++n):delete t[e];break;case"transform":var r,o=0;for(r in t[e])o+=this.refine(r,t[e],s);if(o){for(var d in n+=o,p=[],t[e]){var u=t[e][d];if(!0===u)p=null;else if("object"==typeof u){var c,b,f=[];for(c in u){var m={};m[c]=u[c],f.push(m)}f.length&&((b={})[d]={plugins:f},p.push(b))}}null===p?delete t[e]:t[e]=p}else delete t[e]}return n},window.location.hash="json",new SVGSpriteConfigurator({dest:{type:"string",label:"Main output directory",default:".",skip:3},log:{type:"select",label:"Log verbosity",default:null,skip:3,options:{"":"No logging",info:"Informal",verbose:"Verbose",debug:"Debug information"}},shape:{type:"section",label:"SVG shape properties",skip:3,id:{type:"section",label:"Shape ID properties",skip:3,separator:{type:"string",label:"Directory separator replacement",default:"--",skip:3},generator:{type:"string",label:"Generator template or callback",default:null,skip:3},pseudo:{type:"string",label:"Pseudo-class delimiter",default:"~",skip:3}},dimension:{type:"section",label:"Dimensions",skip:3,maxWidth:{type:"integer",label:"Max. shape width",default:2e3,skip:3},maxHeight:{type:"integer",label:"Max. shape height",default:2e3,skip:3},precision:{type:"integer",label:"Decimal precision",default:2,skip:3},attributes:{type:"boolean",label:"Add dimension attributes",default:!1,skip:3}},spacing:{type:"section",label:"Spacing",skip:3,padding:{type:"integer",label:"Padding on all edges",default:0,skip:3},box:{type:"select",label:"Box sizing strategy",default:"content",skip:3,options:{content:"Content box",padding:"Padding box"}}},meta:{type:"string",label:"Meta data YAML file",skip:3,default:null},align:{type:"string",label:"Alignment data YAML file",skip:3,default:null},dest:{type:"string",label:"SVG shape output directory",skip:3,default:null}},transform:{type:"section",label:"SVG shape transformations",skip:3,process:"transform",svgo:{type:"enableconfig",label:"SVGO",skip:3,default:1,cleanupAttrs:{type:"boolean",label:"Cleanup attributes from whitespace",default:!0,skip:3},removeDoctype:{type:"boolean",label:"Remove DOCTYPE declaration",default:!0,skip:3},removeXMLProcInst:{type:"boolean",label:"Remove XML declaration",default:!0,skip:3},removeComments:{type:"boolean",label:"Remove comments",default:!0,skip:3},removeMetadata:{type:"boolean",label:"Remove <metadata>",default:!0,skip:3},removeTitle:{type:"boolean",label:"Remove <title>",default:!0,skip:3},removeEditorsNSData:{type:"boolean",label:"Remove editor markup",default:!0,skip:3},removeEmptyAttrs:{type:"boolean",label:"Remove empty attributes",default:!0,skip:3},removeHiddenElems:{type:"boolean",label:"Remove hidden elements",default:!0,skip:3},removeEmptyText:{type:"boolean",label:"Remove empty texts",default:!0,skip:3},removeEmptyContainers:{type:"boolean",label:"Remove empty containers",default:!0,skip:3},removeViewBox:{type:"boolean",label:"Remove viewBox",default:!1,skip:3},cleanupEnableBackground:{type:"boolean",label:'Cleanup "enable-background" attribute',default:!0,skip:3},convertStyleToAttrs:{type:"boolean",label:"Convert styles to attributes",default:!0,skip:3},convertColors:{type:"boolean",label:"Convert colors to attributes",default:!0,skip:3},convertPathData:{type:"boolean",label:"Convert path data",default:!0,skip:3},convertTransform:{type:"boolean",label:"Collapse multiple transforms",default:!0,skip:3},removeUnknownsAndDefaults:{type:"boolean",label:"Remove unknown elements and attributes",default:!0,skip:3},removeNonInheritableGroupAttrs:{type:"boolean",label:"Remove non-inheritable presentation attributes",default:!0,skip:3},removeUnusedNS:{type:"boolean",label:"Remove unused namespace declarations",default:!0,skip:3},cleanupIDs:{type:"boolean",label:"Remove unused and minify used IDs",default:!0,skip:3},cleanupNumericValues:{type:"boolean",label:"Round numeric values to fixed precision",default:!0,skip:3},moveElemsAttrsToGroup:{type:"boolean",label:"Move element attributes to group wrappers",default:!0,skip:3},moveGroupAttrsToElems:{type:"boolean",label:"Move some group attributes to content elements",default:!1,skip:3},collapseGroups:{type:"boolean",label:"Collapse useless groups",default:!0,skip:3},removeRasterImages:{type:"boolean",label:"Remove raster images",default:!1,skip:3},mergePaths:{type:"boolean",label:"Merge multiple paths into one",default:!0,skip:3},convertShapeToPath:{type:"boolean",label:"Convert some basic shapes to paths",default:!0,skip:3},transformsWithOnePath:{type:"boolean",label:"Apply transforms, crop by real width",default:!0,skip:3}}},svg:{type:"section",label:"SVG sprite properties",skip:3,xmlDeclaration:{type:"boolean",label:"Add XML declaration",default:!0,skip:3},doctypeDeclaration:{type:"boolean",label:"Add DOCTYPE declaration",default:!0,skip:3},namespaceIDs:{type:"boolean",label:"Apply ID namespacing",default:!0,skip:3},dimensionAttributes:{type:"boolean",label:"Add dimension attributes",default:!0,skip:3}},mode:{type:"section",label:"Output modes",emphasize:!0,skip:3,css:{type:"enableconfig",label:"«css» sprite",default:0,skip:3,dest:{type:"string",label:"Output directory",default:"css",skip:3},layout:{type:"select",label:"Sprite layout",default:"packed",skip:3,options:{vertical:"Vertical",horizontal:"Horizontal",diagonal:"Diagonal",packed:"Packed"}},common:{type:"string",label:"Common CSS class name",default:null,skip:3},prefix:{type:"string",label:"CSS selector prefix",default:".svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix",default:"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name",default:"svg/sprite.css.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting",default:!0,skip:3},render:{type:"section",label:"Rendering configurations",emphasize:!0,skip:3,css:{type:"enableconfig",label:"Render CSS stylesheet",default:0,skip:3,template:{type:"string",label:"CSS stylesheet template",default:"tmpl/css/sprite.css",skip:3},dest:{type:"string",label:"CSS stylesheet destination",default:"sprite.css",skip:3}},scss:{type:"enableconfig",label:"Render Sass stylesheet",default:0,skip:3,template:{type:"string",label:"Sass stylesheet template",default:"tmpl/css/sprite.scss",skip:3},dest:{type:"string",label:"Sass stylesheet destination",default:"sprite.scss",skip:3}},less:{type:"enableconfig",label:"Render LESS stylesheet",default:0,skip:3,template:{type:"string",label:"LESS stylesheet template",default:"tmpl/css/sprite.scss",skip:3},dest:{type:"string",label:"SCSS stylesheet destination",default:"sprite.scss",skip:3}},styl:{type:"enableconfig",label:"Render Stylus stylesheet",default:0,skip:3,template:{type:"string",label:"Stylus stylesheet template",default:"tmpl/css/sprite.styl",skip:3},dest:{type:"string",label:"Stylus stylesheet destination",default:"sprite.styl",skip:3}}},example:{type:"enableconfig",label:"Render HTML example",default:0,skip:3,template:{type:"string",label:"HTML document template",default:"tmpl/css/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination",default:"sprite.css.html",skip:3}}},view:{type:"enableconfig",label:"«view» sprite",default:0,skip:3,dest:{type:"string",label:"Output directory",default:"view",skip:3},layout:{type:"select",label:"Sprite layout",default:"packed",skip:3,options:{vertical:"Vertical",horizontal:"Horizontal",diagonal:"Diagonal",packed:"Packed"}},common:{type:"string",label:"Common CSS class name",default:null,skip:3},prefix:{type:"string",label:"CSS selector prefix",default:".svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix",default:"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name",default:"svg/sprite.view.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting",default:!0,skip:3},render:{type:"section",label:"Rendering configurations",emphasize:!0,skip:3,css:{type:"enableconfig",label:"Render CSS stylesheet",default:0,skip:3,template:{type:"string",label:"CSS stylesheet template",default:"tmpl/view/sprite.css",skip:3},dest:{type:"string",label:"CSS stylesheet destination",default:"sprite.css",skip:3}},scss:{type:"enableconfig",label:"Render Sass stylesheet",default:0,skip:3,template:{type:"string",label:"Sass stylesheet template",default:"tmpl/view/sprite.scss",skip:3},dest:{type:"string",label:"Sass stylesheet destination",default:"sprite.scss",skip:3}},less:{type:"enableconfig",label:"Render LESS stylesheet",default:0,skip:3,template:{type:"string",label:"LESS stylesheet template",default:"tmpl/view/sprite.scss",skip:3},dest:{type:"string",label:"SCSS stylesheet destination",default:"sprite.scss",skip:3}},styl:{type:"enableconfig",label:"Render Stylus stylesheet",default:0,skip:3,template:{type:"string",label:"Stylus stylesheet template",default:"tmpl/view/sprite.styl",skip:3},dest:{type:"string",label:"Stylus stylesheet destination",default:"sprite.styl",skip:3}}},example:{type:"enableconfig",label:"Render HTML example",default:0,skip:3,template:{type:"string",label:"HTML document template",default:"tmpl/view/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination",default:"sprite.view.html",skip:3}}},defs:{type:"enableconfig",label:"«defs» sprite",default:0,skip:3,dest:{type:"string",label:"Output directory",default:"defs",skip:3},prefix:{type:"string",label:"CSS selector prefix",default:".svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix",default:"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name",default:"svg/sprite.defs.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting",default:!1,skip:3},inline:{type:"boolean",label:"Prepare for inline embedding",default:!1,skip:3},example:{type:"enableconfig",label:"Render HTML example",default:0,skip:3,template:{type:"string",label:"HTML document template",default:"tmpl/defs/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination",default:"sprite.defs.html",skip:3}}},symbol:{type:"enableconfig",label:"«symbol» sprite",default:0,skip:3,dest:{type:"string",label:"Output directory",default:"symbol",skip:3},prefix:{type:"string",label:"CSS selector prefix",default:".svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix",default:"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name",default:"svg/sprite.symbol.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting",default:!1,skip:3},inline:{type:"boolean",label:"Prepare for inline embedding",default:!1,skip:3},example:{type:"enableconfig",label:"Render HTML example",default:0,skip:3,template:{type:"string",label:"HTML document template",default:"tmpl/symbol/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination",default:"sprite.symbol.html",skip:3}}},stack:{type:"enableconfig",label:"«stack» sprite",default:0,skip:3,dest:{type:"string",label:"Output directory",default:"stack",skip:3},prefix:{type:"string",label:"CSS selector prefix",default:".svg-%s",skip:3},dimensions:{type:"string",label:"Dimension CSS selector suffix",default:"-dims",skip:3},sprite:{type:"string",label:"Sprite path & file name",default:"svg/sprite.stack.svg",skip:3},bust:{type:"boolean",label:"Enable cache busting",default:!1,skip:3},example:{type:"enableconfig",label:"Render HTML example",default:0,skip:3,template:{type:"string",label:"HTML document template",default:"tmpl/stack/sprite.html",skip:3},dest:{type:"string",label:"HTML document destination",default:"sprite.stack.html",skip:3}}}},variables:{type:"manual",label:"Custom Mustache templating variables",skip:3}},$("#configurator"),$("#compiled"),$(".tabs a"),!0),window.setTimeout(function(){window.scrollTo(0,0)},0);